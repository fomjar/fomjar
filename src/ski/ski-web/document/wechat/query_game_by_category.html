<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'/>
        <meta name='viewport' content='width=device-width,initial-scale=1,user-scalable=0'/>
        <title></title>
        <link rel='stylesheet' href='/css/weui.css'/>
        <script type='text/javascript' src='/js/jquery.js'></script>
        <script type='text/javascript' src='/js/jquery.json.js'></script>
        <script type='text/javascript' src='/js/jquery.cookie.js'></script>
        <script type='text/javascript' src='/js/ski.js'></script>
        <style type="text/css">
        td {
            white-space: nowrap;
        }
        .rent_enable {
            text-align  : center;
            font-size   : 10px;
            color       : white;
            background  : #00C802;
            -webkit-border-radius   : 6px;
            -moz-border-radius      : 6px;
        }
        .rent_disable {
            text-align  : center;
            font-size   : 10px;
            color       : white;
            background  : #B2B2B2;
            -webkit-border-radius   : 6px;
            -moz-border-radius      : 6px;
        }
        </style>
        <script type='text/javascript'>
            var category = ski.urlparams().category;

            $(document).ready(function() {
                ski.ui.set_title(category);
            
                ski.ui.show_toast('正在加载');
                ski.common.query_game({category : category}, function(args) {
                    ski.ui.hide_toast();
                    if (0 != args.code) {
                        ski.ui.show_dialog_alert({
                            head    : '加载失败',
                            body    : args.desc
                        });
                        return;
                    }
                    var games = args.desc;
                    var title = document.createElement('div');
                    title.className = 'weui_panel_hd';
                    title.innerText = category;
                        
                    var cells = document.createElement('div');
                    cells.className = 'weui_panel_bd';
                    for (var i in games) {
                        var game = games[i];
                        var cell = "<a class='weui_media_box weui_media_appmsg' href=\"javascript:ski.goto.game(" + game.gid + ");\">"
                                     + "<div class='weui_media_hd'><img class='weui_media_appmsg_thumb' src='" + game.url_icon + "'></div>"
                                     + "<div class='weui_media_bd'>"
                                        + "<h4 class='weui_media_title'>" + game.name_zh_cn + "</h4>"
                                        + "<p class='weui_media_desc'>" + game.introduction + "</p>"
                                     + "</div>"
                                     + "<div style='position: absolute; width: 70px; top: 20px; right: 20px'><table width='100%'><tr>"
                                         + "<td><div class='" + (game.rent_avail_a ? "rent_enable" : "rent_disable") + "'>认证</div></td>"
                                         + "<td><div class='" + (game.rent_avail_b ? "rent_enable" : "rent_disable") + "'>不认证</div></td>"
                                     + "</tr></table></div>"
                                 + "</a>";
                        cells.innerHTML = cells.innerHTML + cell;
                    }
                    $('#result').html(title);
                    $('#result').append(cells);
                });
            });
        </script>
    </head>
    <body>
        <div class='panel'>
            <div class='bd'>
                <div class="weui_panel weui_panel_access" style='margin-top: 0px' id='result'>
                </div>
            </div>
        </div>
    </body>
</html>

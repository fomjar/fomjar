<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'/>
        <meta name='viewport' content='width=device-width,initial-scale=1,user-scalable=0'/>
        <title>⚙淘宝＋</title>
        <link rel='stylesheet' href='/css/weui.css'/>
        <script type='text/javascript' src='/js/jquery.js'></script>
        <script type='text/javascript' src='/js/jquery.json.js'></script>
        <script type='text/javascript' src='/js/jquery.cookie.js'></script>
        <script type='text/javascript' src='/js/ski.js'></script>
        <script type='text/javascript'>
            $(document).ready(function() {
                ski.ui.show_toast('正在加载');
                ski.common.query_platform_account_map(function(args) {
                    ski.ui.hide_toast();
                    if (0 != args.code) {
                        ski.ui.show_dialog_alert({
                            head : '加载失败',
                            body : args.desc
                        });
                        return;
                    }

                    var users = args.desc;
                    var hasTaobao = false;
                    for (var i in users) {
                        var account = users[i];

                        var title = document.createElement('div');
                        title.className = 'weui_cells_title';
                        title.innerText = getChannelDesc(account.channel);

                        var cells = document.createElement('div');
                        cells.className = 'weui_cells';

                        switch (account.channel) {
                        case 0: // 淘宝
                            hasTaobao = true;
                            cells.innerHTML += "<div class='weui_cell'><div class='weui_cell_bd weui_cell_primary'><p>帐号</p></div><div class='weui_cell_ft'>" + account.user + "</div></div>";
                            break;
                        case 1: // 微信
                            cells.innerHTML += "<div class='weui_cell'><div class='weui_cell_bd weui_cell_primary'><p>昵称</p></div><div class='weui_cell_ft'>" + account.name + "</div></div>";
                            cells.innerHTML += "<div class='weui_cell'><div class='weui_cell_bd weui_cell_primary'><p>手机</p></div><div class='weui_cell_ft'>" + account.phone + "</div></div>";
                            break;
                        case 2: // 支付宝
                            cells.innerHTML += "<div class='weui_cell'><div class='weui_cell_bd weui_cell_primary'><p>帐号</p></div><div class='weui_cell_ft'>" + account.user + "</div></div>";
                            break;
                        case 3: // PSN
                            cells.innerHTML += "<div class='weui_cell'><div class='weui_cell_bd weui_cell_primary'><p>PSN ID</p></div><div class='weui_cell_ft'>" + account.user + "</div></div>";
                            break;
                        }

                        $('#result').append(title);
                        $('#result').append(cells);
                    }
                    if (!hasTaobao) {
                        $('#result').append("<div class='weui_cells'><p style='padding: 15px; color: gray; font-size: 80%'>"
                                + "TIPS:<br/>"
                                + "如果您曾在\"VC电玩\"淘宝店铺消费，请联系淘宝客服录入手机号。<br/>"
                                + "录入手机之后可以关联到您的消费记录、账户余额等信息哦～<p></div>");
                    }
                });
            });

            function getChannelDesc (channel) {
                switch (channel) {
                case 0:     return '淘宝';
                case 1:     return '微信';
                case 2:     return '支付宝';
                case 3:     return 'Sony Plastation';
                default:    return '未知';
                }
            }

        </script>
    </head>
    <body>
        <div class='cell'>
            <div class='hd'>
                <h1 class='page_title'>我的账号</h1>
            </div>
            <div class='bd'>
                <div id='result'></div>
                <div class="weui_btn_area">
                    <a class="weui_btn weui_btn_primary" href="javascript: ski.goto.update_platform_account_map();">更新</a>
                </div>
            </div>
        </div>
    </body>
</html>

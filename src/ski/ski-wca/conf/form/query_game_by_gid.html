<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'/>
        <meta name='viewport' content='width=device-width,initial-scale=1,user-scalable=0'/>
        <title>游戏详情</title>
        <link rel='stylesheet' href='/ski-wcweb/weui/dist/style/weui.min.css'/>
        <link rel='stylesheet' href='/ski-wcweb/weui/dist/example/example.css'/>
        <link rel='stylesheet' href='/ski-wcweb/lib/jquery.skippr.css'/>
        <script type='text/javascript' src='/ski-wcweb/lib/jquery-3.0.0.min.js'></script>
        <script type='text/javascript' src='/ski-wcweb/lib/jquery.json.min.js'></script>
        <script type='text/javascript' src='/ski-wcweb/lib/jquery.skippr.min.js'></script>
        <script type='text/javascript' src='http://res.wx.qq.com/open/js/jweixin-1.0.0.js'></script>
        <script type='text/javascript'>
            var user = %d;
            var gid  = %d;
            var url_setup = '/ski-wcweb?inst=2001&user=' + user.toString(16) + '&step=setup';
            var url_rent_begin = '/ski-wcweb?inst=2106&user=' + user.toString(16) + '&gid=' + gid.toString(16);

            $(document).ready(function() {
                showToast('正在加载');
                $.post(url_setup,$.toJSON({
                        'gid'   : gid.toString(16)
                    }),
                    function(args) {
                        hideToast();
                        if (0 != args.code) {
                            showDialog("加载失败", args.desc);
                            return;
                        }
                        $('#poster').append("<div style='background-image: url(" + args.desc.url_cover + ")'/>");
                        if (0 < args.desc.url_poster.length) {
                            for (var i in args.desc.url_poster) {
                                var poster = args.desc.url_poster[i];
                                if (0 == poster.length) continue;

                                $('#poster').append("<div style='background-image: url(" + poster + ")'/>");
                            }
                        }
                        $('#name_zh_cn').text(args.desc.name_zh_cn);
                        $('#name_en').text(args.desc.name_en);
                        $('#category').text(args.desc.category);
                        $('#vendor').text(args.desc.vendor);
                        $('#sale').text(args.desc.sale);
                        $('#introduction').text(args.desc.introduction);

                        if (0 < args.desc.vedio.length) {
                            $('#vedio')[0].innerHTML = "<embed allowfullscreen='true' src='" + args.desc.vedio + "'/>";
                        }

                        if (args.desc.rent_a) {
                            $('#rent')[0].innerHTML = "<div class='weui_cell'>"
                                    + "<div class='weui_cell_bd weui_cell_primary'><p>认证</p></div>"
                                    + "<div class='weui_cell_ft'>" + args.desc.price_a + " 元/天</div>"
                                    + "</div>";
                        }
                        if (args.desc.rent_b) {
                            $('#rent')[0].innerHTML += "<div class='weui_cell'>"
                                    + "<div class='weui_cell_bd weui_cell_primary'><p>不认证</p></div>"
                                    + "<div class='weui_cell_ft'>" + args.desc.price_b + " 元/天</div>"
                                    + "</div>";
                        }
                        if (!args.desc.rent_a && !args.desc.rent_b) $('#rent_begin').hide();

                        $('#poster').skippr({
                            transition: 'slide',
                            speed: 1000,
                            easing: 'easeOutQuart',
                            navType: 'block',
                            childrenElementType: 'div',
                            arrows: false,
                            autoPlay: true,
                            autoPlayDuration: 3000,
                            keyboardOnAlways: true,
                            hidePrevious: false
                        });
                    });
            });

            function rentBegin() {
                window.location = url_rent_begin;
            }

            function showToast(text) {
                $('#toast_text').text(text);
                $('#toast').show();
            }
            function hideToast() {
                $('#toast').hide();
            }

            function showDialog(head, body) {
                $('#result_head').text(head);
                $('#result_body').text(body);
                $('#dialog').show();
            }
            function showDialog1(head, body) {
                $('#result_head1').text(head);
                $('#result_body1').text(body);
                $('#dialog1').show();
            }
        </script>
    </head>
    <body>
        <div class='cell'>
            <div class='bd'>
                <article class='weui_article'>
                    <p>
                        <div style='width: 100%%; height: 200px'>
                            <div id='poster'></div>
                        </div>
                    <p>
                    <section>
                        <h1>游戏介绍</h1>
                        <section>
                            <section>
                                <p id='introduction'></p>
                            </section>
                            <section align='center' id='vedio'>
                            </section>
                        </section>
                    </section>
                </article>
                <div class="weui_cells">
                    <div class="weui_cell">
                        <div class="weui_cell_bd weui_cell_primary"><p>简体中文名</p></div>
                        <div class="weui_cell_ft" id='name_zh_cn'></div>
                    </div>
                    <div class="weui_cell">
                        <div class="weui_cell_bd weui_cell_primary"><p>英文名</p></div>
                        <div class="weui_cell_ft" id='name_en'></div>
                    </div>
                    <div class="weui_cell">
                        <div class="weui_cell_bd weui_cell_primary"><p>游戏类型</p></div>
                        <div class="weui_cell_ft" id='category'></div>
                    </div>
                    <div class="weui_cell">
                        <div class="weui_cell_bd weui_cell_primary"><p>发行商</p></div>
                        <div class="weui_cell_ft" id='vendor'></div>
                    </div>
                    <div class="weui_cell">
                        <div class="weui_cell_bd weui_cell_primary"><p>发售日期</p></div>
                        <div class="weui_cell_ft" id='sale'></div>
                    </div>
                </div>
                <div class="weui_cells" id='rent'>
                </div>
                <div class='weui_btn_area' id='rent_begin'>
                    <a class='weui_btn weui_btn_primary' href="javascript:rentBegin();">我要租</a>
                </div>
            </div>
        </div>
        <div class="weui_dialog_alert" id="dialog" style='display:none'>
            <div class="weui_mask"></div>
            <div class="weui_dialog">
                <div class="weui_dialog_hd"><strong class="weui_dialog_title" id='result_head'></strong></div>
                <div class="weui_dialog_bd" id='result_body'></div>
                <div class="weui_dialog_ft">
                    <a class="weui_btn_dialog primary" href="javascript:$('#dialog').hide();">确定</a>
                </div>
            </div>
        </div>
        <div class="weui_loading_toast" id="toast" style="display: none;">
            <div class="weui_mask_transparent"></div>
            <div class="weui_toast">
                <div class="weui_loading">
                    <div class="weui_loading_leaf weui_loading_leaf_0"></div>
                    <div class="weui_loading_leaf weui_loading_leaf_1"></div>
                    <div class="weui_loading_leaf weui_loading_leaf_2"></div>
                    <div class="weui_loading_leaf weui_loading_leaf_3"></div>
                    <div class="weui_loading_leaf weui_loading_leaf_4"></div>
                    <div class="weui_loading_leaf weui_loading_leaf_5"></div>
                    <div class="weui_loading_leaf weui_loading_leaf_6"></div>
                    <div class="weui_loading_leaf weui_loading_leaf_7"></div>
                    <div class="weui_loading_leaf weui_loading_leaf_8"></div>
                    <div class="weui_loading_leaf weui_loading_leaf_9"></div>
                    <div class="weui_loading_leaf weui_loading_leaf_10"></div>
                    <div class="weui_loading_leaf weui_loading_leaf_11"></div>
                </div>
                <p class="weui_toast_content" id='toast_text'></p>
            </div>
        </div>
    </body>
</html>

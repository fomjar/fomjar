<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <body>
        <a th:fragment="panel(article)"
           th:href="@{/article/view(aid=${article.aid})}"
           th:with="day=${(#dates.createNow().time - article.time_update) / 1000 / 60 / 60 / 24}">
            <style>
                a {
                    text-decoration : none;
                }
                a:hover {
                    text-decoration : none;
                }
                .panel:hover {
                    background-color    : #eee;
                }
                .panel .panel-body h4 {
                    margin  : 0;
                }
                .panel .panel-body h4 div {
                    display    : inline;
                }
                .panel .panel-body h4 span {
                    position    : relative;
                    top         : -.2em;
                    margin-left : 1em;
                    font-size   : 60%;
                }
                .panel .panel-body h4 small {
                    float       : right;
                    line-height : 1.5em;
                }
            </style>
            <div class="panel panel-default">
                <link rel="stylesheet" th:href="@{/bootstrap/css/bootstrap.css}" />
                <div class="panel-body">
                    <h4>
                        <div th:text="${article.name}"></div>
                        <span class="label label-danger" th:if="${day <= 30}">new</span>
                        <small th:text="${#dates.format(article.time_create, 'yyyy/MM/dd HH:mm:ss')}"></small>
                    </h4>
                </div>
            </div>
        </a>
        
        
        
        <div th:fragment="view(article, markdown)"
             th:with="id=${#dates.createNow().time}">
            <link rel="stylesheet" th:href="@{/editormd/css/editormd.css}" />
            <style>
                ol {
                    padding-left : 3em !important;
                }
                .editormd .CodeMirror {
                    margin-top    : 0;
                }
            </style>
            <div th:attr="id=${'editormd-' + id}">
                <textarea style="display:none;" th:text="${markdown}"></textarea>
            </div>
            <script th:src="@{/editormd/examples/js/jquery.min.js}"></script>
            <script th:src="@{/editormd/lib/marked.min.js}"></script>
            <script th:src="@{/editormd/lib/prettify.min.js}"></script>
            <script th:src="@{/editormd/lib/raphael.min.js}"></script>
            <script th:src="@{/editormd/lib/underscore.min.js}"></script>
            <script th:src="@{/editormd/lib/sequence-diagram.min.js}"></script>
            <script th:src="@{/editormd/lib/flowchart.min.js}"></script>
            <script th:src="@{/editormd/lib/jquery.flowchart.min.js}"></script>
            <script th:src="@{/editormd/editormd.min.js}"></script>
            <script th:inline="javascript">
                editormd.markdownToHTML([[${'editormd-' + id}]], {
                        //htmlDecode      : true,       // 开启 HTML 标签解析，为了安全性，默认不开启
                        htmlDecode      : "style,script,iframe",  // you can filter tags decode
                        //toc             : false,
                        tocm            : true,    // Using [TOCM]
                        //tocContainer    : "#custom-toc-container", // 自定义 ToC 容器层
                        //gfm             : false,
                        //tocDropdown     : true,
                        //markdownSourceCode : true, // 是否保留 Markdown 源码，即是否删除保存源码的 Textarea 标签
                        taskList        : true,
                        tex             : true,  // 默认不解析
                        flowChart       : true,  // 默认不解析
                        sequenceDiagram : true,  // 默认不解析
                });
            </script>
        </div>
        
        
        
        <div th:fragment="edit(article, markdown)"
             th:with="id=${#dates.createNow().time}">
            <link rel="stylesheet" th:href="@{/editormd/css/editormd.css}" />
            <style>
                ol {
                    padding-left : 3em !important;
                }
                .editormd .CodeMirror {
                    margin-top    : 0;
                }
            </style>
            <div th:attr="id=${'editormd-' + id}">
                <textarea style="display:none;" name="markdown" th:text="${markdown}"></textarea>
            </div>
            <script th:src="@{/editormd/examples/js/jquery.min.js}"></script>
            <script th:src="@{/editormd/lib/marked.min.js}"></script>
            <script th:src="@{/editormd/lib/prettify.min.js}"></script>
            <script th:src="@{/editormd/lib/raphael.min.js}"></script>
            <script th:src="@{/editormd/lib/underscore.min.js}"></script>
            <script th:src="@{/editormd/lib/sequence-diagram.min.js}"></script>
            <script th:src="@{/editormd/lib/flowchart.min.js}"></script>
            <script th:src="@{/editormd/lib/jquery.flowchart.min.js}"></script>
            <script th:src="@{/editormd/editormd.min.js}"></script>
            <script th:inline="javascript">
                editormd({
                        id          : [[${'editormd-' + id}]],
                        path        : [[@{/editormd/lib/}]],
                        width       : "100%",
                        autoHeight  : true,
                        autoFocus   : false,
                        watch       : false,
                        toolbar     : false,
                        lineNumbers : false,
                        placeholder : '开始输入...'
                });
            </script>
        </div>
    </body>
</html>